<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guaraní Finest Brew</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .hero {
            background-image: linear-gradient(rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)), url('https://res.cloudinary.com/dweom4cyp/image/upload/v1754132674/garani_finest_brew_o9uplf.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            height: 80vh;
            max-width: 3189px;
            width: 100%;
            margin: 0 auto;
            position: relative;
        }
        .hero-content {
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            width: 100%;
            padding: 0 1rem;
        }
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 50;
            align-items: center;
            justify-content: center;
        }
        .modal.open {
            display: flex;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1);
        }
        .confirmation-message {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: #10b981;
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .chatbot {
            position: fixed;
            bottom: 8rem;
            right: 1rem;
            z-index: 100;
        }
        .chatbot-container {
            display: none;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
        }
        .chatbot-container.open {
            display: block;
        }
        .chat-message {
            padding: 0.5rem;
            margin: 0.5rem;
            border-radius: 0.5rem;
        }
        .user-message {
            background: #f3f4f6;
            text-align: right;
        }
        .bot-message {
            background: #fee2e2;
            text-align: left;
        }
        .newsletter-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(245,245,220,0.7);
            color: #4b5563;
            padding: 1rem;
            text-align: center;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 0.25rem;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-content a {
            color: #4b5563;
            padding: 0.5rem 1rem;
            text-decoration: none;
            display: block;
        }
        .dropdown-content a:hover {
            background-color: #f3f4f6;
        }
        .dropdown-content .dropdown-sub {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
            background-color: #fff;
            min-height: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            border-radius: 0.25rem;
        }
        .dropdown-content .sub-dropdown:hover .dropdown-sub {
            display: block;
        }
        .language-select, .currency-select {
            display: inline-block;
            margin-left: 0.5rem;
            padding: 0.3rem 0.8rem;
            background-color: #fff;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.9rem;
        }
        header nav a {
            font-size: 0.9rem;
        }
        header .flex {
            align-items: center;
        }
        .caffeine-option {
            display: flex !important;
            align-items: center;
            margin-right: 1rem;
        }
        .caffeine-option input[type="radio"] {
            margin-right: 0.5rem;
            display: inline-block !important;
            width: auto !important;
        }
        .caffeine-option label {
            display: inline !important;
        }
        .caffeine-options {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 1rem;
        }
        @media (max-width: 768px) {
            header nav {
                display: none;
            }
            header .flex {
                flex-direction: column;
                align-items: flex-start;
            }
            .language-select, .currency-select {
                margin: 0.5rem 0;
            }
        }
    </style>
</head>

<body class="font-sans bg-beige-50 text-gray-800">
    <header class="sticky top-0 z-50 bg-white shadow-md">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-red-800">Guaraní Finest Brew</h1>
            <nav class="space-x-4">
                <a href="#products" class="text-gray-700 hover:text-red-800" data-translate="nav-products">Products</a>
                <a href="#about" class="text-gray-700 hover:text-red-800" data-translate="nav-about">About</a>
                <a href="#contact" class="text-gray-700 hover:text-red-800" data-translate="nav-contact">Contact</a>
                <a href="#promotions" class="text-gray-700 hover:text-red-800" data-translate="nav-promotions">Promotions</a>
            </nav>
            <div class="flex space-x-4 items-center">
                <select id="language-select" class="language-select">
                    <option value="en">English</option>
                    <option value="fr">Français</option>
                    <option value="es">Español</option>
                </select>
                <select id="currency-select" class="currency-select">
                    <option value="EUR">€ (EUR)</option>
                    <option value="USD">$ (USD)</option>
                    <option value="CHF">CHF (CHF)</option>
                </select>
                <a href="login.html" class="bg-red-800 hover:bg-red-900 text-white px-4 py-2 rounded-full transition" data-translate="login-button">Log In</a>
                <button id="cart-btn" class="relative">
                    <i class="fas fa-shopping-cart text-xl text-gray-700 hover:text-red-800"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-800 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </button>
            </div>
        </div>
    </header>

    <section class="hero flex items-center justify-center">
        <div class="hero-content">
            <h2 class="text-3xl font-bold mb-4" style="color: #FFD700;" data-translate="hero-title">Exceptional Flavors</h2>
            <a href="#products" class="bg-red-800 hover:bg-red-900 text-white px-6 py-2 rounded-full transition" data-translate="view-products">View Products</a>
        </div>
    </section>

    <section id="products" class="py-12 bg-white">
        <div class="container mx-auto px-4">
            <h2 class="text-2xl font-bold text-center text-red-800 mb-8" data-translate="products-title">Our Products</h2>
            <div class="flex justify-center space-x-4 mb-8">
                <button class="category-filter bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-category="all" data-translate="filter-all">All</button>
                <button class="category-filter bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-category="coffee" data-translate="filter-coffee">Coffee</button>
                <button class="category-filter bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-category="tea" data-translate="filter-tea">Tea</button>
                <button class="category-filter bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-category="oil" data-translate="filter-essential-oils">Essential Oils</button>
            </div>
            <div id="product-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="product-card bg-white rounded-lg shadow-md transition">
                    <img src="https://res.cloudinary.com/dweom4cyp/image/upload/v1753896069/caf%C3%A9%20de%20Veracruz.jpg" alt="Veracruzano Premium Export" class="w-full h-48 object-cover rounded-t-lg">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold" data-translate="veracruzano-name">Veracruzano Premium Export</h3>
                        <p class="text-gray-600 text-sm mb-2" data-translate="veracruzano-desc">Floral and citrus notes.</p>
                        <div class="mb-2">
                            <label for="capacity-coffee1" class="block text-gray-700 text-sm font-medium mb-1" data-translate="capacity-label">Quantity</label>
                            <select id="capacity-coffee1" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">
                                <option value="250g">250g</option>
                                <option value="500g">500g</option>
                                <option value="1kg">1kg</option>
                            </select>
                        </div>
                        <div class="mb-2">
                            <label for="grind-coffee1" class="block text-gray-700 text-sm font-medium mb-1" data-translate="grind-label">Bean Type</label>
                            <select id="grind-coffee1" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">
                                <option value="whole" data-translate="grind-whole">Whole</option>
                                <option value="ground" data-translate="grind-ground">Ground</option>
                                <option value="espresso" data-translate="grind-espresso">Espresso</option>
                            </select>
                        </div>
                        <div class="mb-2 caffeine-options">
                            <div class="caffeine-option">
                                <input type="radio" id="classic-coffee1" name="caffeine-coffee1" value="classic" checked>
                                <label for="classic-coffee1" data-translate="classic-label">Classic</label>
                            </div>
                            <div class="caffeine-option">
                                <input type="radio" id="decaf-coffee1" name="caffeine-coffee1" value="decaf">
                                <label for="decaf-coffee1" data-translate="decaf-label">Decaf</label>
                            </div>
                        </div>
                        <div class="flex justify-between items-center">
                            <span id="price-coffee1" class="text-red-800 font-bold">88.24€</span>
                            <a href="coffee1.html" class="text-blue-600 hover:underline" data-translate="details-link">Details</a>
                            <button class="add-to-cart bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-id="coffee1" data-translate="add-to-cart">Add</button>
                        </div>
                    </div>
                </div>
                <!-- Other similar product cards... -->
            </div>
        </div>
    </section>

    <section id="promotions" class="py-12 bg-beige-100">
        <div class="container mx-auto px-4">
            <h2 class="text-2xl font-bold text-center text-red-800 mb-8" data-translate="promotions-title">Promotions</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="product-card bg-white rounded-lg shadow-md">
                    <img src="https://res.cloudinary.com/dweom4cyp/image/upload/v1753896691/Illy%20Cafe%20Classic.jpg" alt="Illy Cafe Classic" class="w-full h-48 object-cover rounded-t-lg">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold" data-translate="illy-name">Illy Cafe Classic</h3>
                        <p class="text-gray-600 text-sm mb-2" data-translate="illy-desc">100% Arabica Brazil</p>
                        <span id="discount-illy" class="bg-red-800 text-white px-2 py-1 rounded text-sm" data-translate="discount-label"></span>
                        <p id="price-illy" class="text-red-800 font-bold mt-2"></p>
                    </div>
                </div>
                <div class="product-card bg-white rounded-lg shadow-md">
                    <img src="https://res.cloudinary.com/dweom4cyp/image/upload/v1753961202/guarana-bio.webp" alt="Guarana" class="w-full h-48 object-cover rounded-t-lg">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold" data-translate="guarana-name">Guarana</h3>
                        <p class="text-gray-600 text-sm mb-2" data-translate="guarana-desc">Energy support, cognitive performance</p>
                        <span id="discount-guarana" class="bg-red-800 text-white px-2 py-1 rounded text-sm" data-translate="discount-label"></span>
                        <p id="price-guarana" class="text-red-800 font-bold mt-2"></p>
                    </div>
                </div>
                <div class="product-card bg-white rounded-lg shadow-md">
                    <img src="https://res.cloudinary.com/dweom4cyp/image/upload/v1754049551/Huile_cynara_ykxtvq.png" alt="Cynara Oil" class="w-full h-48 object-cover rounded-t-lg">
                    <div class="p-4">
                        <h3 class="text-lg font-semibold" data-translate="cynara-name">Cynara Oil</h3>
                        <p class="text-gray-600 text-sm mb-2" data-translate="cynara-desc">Antioxidant and detoxifying.</p>
                        <span id="discount-cynara" class="bg-red-800 text-white px-2 py-1 rounded text-sm" data-translate="discount-label"></span>
                        <p id="price-cynara" class="text-red-800 font-bold mt-2"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="py-12 bg-white">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold text-red-800 mb-4" data-translate="about-title">About</h2>
            <p class="text-gray-600 mb-4" data-translate="about-text">Guaraní Finest Brew celebrates authentic flavors from around the world. Since 2025, we carefully select coffees, teas, and essential oils to offer you a unique experience in Paraguay. <a href="about.html" class="text-red-800 underline" data-translate="discover-link">Discover our story</a>.</p>
            <div class="flex justify-center space-x-4 mt-4">
                <i class="fab fa-instagram text-2xl text-gray-700 hover:text-red-800"></i>
                <i class="fab fa-facebook-f text-2xl text-gray-700 hover:text-red-800"></i>
                <i class="fab fa-twitter text-2xl text-gray-700 hover:text-red-800"></i>
            </div>
        </div>
    </section>

    <section id="contact" class="py-12 bg-beige-100">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold text-red-800 mb-4" data-translate="contact-title">Contact</h2>
            <p class="text-gray-600 mb-4" data-translate="contact-text">123 Flavor Street, Asunción, Paraguay | Email: contact@guaranifinestbrew.com</p>
            <form id="contact-form" class="max-w-md mx-auto space-y-4">
                <div>
                    <input type="text" id="contact-name" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Your name" data-translate="name-placeholder">
                </div>
                <div>
                    <input type="email" id="contact-email" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Your email" data-translate="email-placeholder">
                </div>
                <div>
                    <textarea id="contact-message" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Your message" rows="4" data-translate="message-placeholder"></textarea>
                </div>
                <button type="submit" class="w-full px-4 py-2 bg-red-800 hover:bg-red-900 text-white rounded transition" data-translate="send-button">Send</button>
            </form>
        </div>
    </section>

    <div id="cart-modal" class="modal">
        <div class="bg-white rounded-lg p-6 w-full max-w-3xl mx-4 max-h-[80vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-red-800" data-translate="cart-title">Cart & Order</h3>
                <button id="close-cart" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="cart-items" class="mb-4 max-h-[300px] overflow-y-auto">
                <p class="text-gray-500 text-center py-4" data-translate="cart-empty">Your cart is empty</p>
            </div>
            <div class="border-t pt-4 mb-4">
                <div class="flex justify-between mb-4">
                    <span class="font-medium" data-translate="total-label">Total</span>
                    <span id="cart-total">0.00€</span>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3 mb-3">
                <div>
                    <label for="first-name" class="block text-gray-700 text-sm font-medium mb-1" data-translate="first-name-label">First Name</label>
                    <input type="text" id="first-name" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="John" data-translate="first-name-placeholder">
                </div>
                <div>
                    <label for="last-name" class="block text-gray-700 text-sm font-medium mb-1" data-translate="last-name-label">Last Name</label>
                    <input type="text" id="last-name" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Doe" data-translate="last-name-placeholder">
                </div>
            </div>
            <div class="mb-3">
                <label for="email" class="block text-gray-700 text-sm font-medium mb-1" data-translate="email-label">Email</label>
                <input type="email" id="email" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="john.doe@gmail.com" data-translate="email-placeholder">
            </div>
            <div class="mb-3">
                <label for="address" class="block text-gray-700 text-sm font-medium mb-1" data-translate="address-label">Address</label>
                <input type="text" id="address" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="123 Example Street" data-translate="address-placeholder">
            </div>
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div>
                    <label for="city" class="block text-gray-700 text-sm font-medium mb-1" data-translate="city-label">City</label>
                    <input type="text" id="city" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Asunción" data-translate="city-placeholder">
                </div>
                <div>
                    <label for="postal-code" class="block text-gray-700 text-sm font-medium mb-1" data-translate="postal-code-label">Postal Code</label>
                    <input type="text" id="postal-code" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="1234" data-translate="postal-code-placeholder">
                </div>
            </div>
            <div class="mb-4">
                <label for="country" class="block text-gray-700 text-sm font-medium mb-1" data-translate="country-label">Country</label>
                <select id="country" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">
                    <option value="" data-translate="country-placeholder">Select a country</option>
                    <option value="FR">France</option>
                    <option value="US">United States</option>
                    <option value="PY">Paraguay</option>
                    <option value="ES">Spain</option>
                    <option value="DE">Germany</option>
                    <option value="IT">Italy</option>
                    <option value="GB">United Kingdom</option>
                    <option value="CA">Canada</option>
                    <option value="AU">Australia</option>
                    <option value="JP">Japan</option>
                </select>
            </div>
            <div class="mb-4">
                <label for="shipping-carrier" class="block text-gray-700 text-sm font-medium mb-1" data-translate="carrier-label">Carrier</label>
                <select id="shipping-carrier" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">
                    <option value="" data-translate="carrier-placeholder">Select a carrier</option>
                    <option value="ups">UPS</option>
                    <option value="dhl">DHL</option>
                    <option value="chronopost">Chronopost</option>
                    <option value="mondialrelay">Mondial Relay</option>
                </select>
            </div>
            <div class="mb-4">
                <label for="shipping-method" class="block text-gray-700 text-sm font-medium mb-1" data-translate="method-label">Shipping Method</label>
                <select id="shipping-method" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" disabled>
                    <option value="" data-translate="method-placeholder">Select a method</option>
                </select>
            </div>
            <div class="mb-4">
                <p id="shipping-details" class="text-gray-600 text-sm" data-translate="shipping-details">Price: -€ | Delivery: - days</p>
            </div>
            <div class="mb-4">
                <label for="payment" class="block text-gray-700 text-sm font-medium mb-1" data-translate="payment-label">Payment</label>
                <select id="payment" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">
                    <option value="visa">Visa</option>
                    <option value="mastercard">Mastercard</option>
                    <option value="paypal">PayPal</option>
                    <option value="bank_transfer" data-translate="bank-transfer">Bank Transfer</option>
                </select>
            </div>
            <div class="flex justify-end space-x-4">
                <button id="confirm-btn" class="px-4 py-2 bg-red-800 hover:bg-red-900 text-white rounded transition" disabled data-translate="confirm-button">Confirm Order</button>
            </div>
        </div>
    </div>

    <div class="chatbot">
        <button id="chatbot-toggle" class="bg-red-800 text-white p-3 rounded-full hover:bg-red-900">
            <i class="fas fa-comment text-xl"></i>
        </button>
        <div id="chatbot-container" class="chatbot-container">
            <div id="chatbot-messages" class="p-4"></div>
            <div class="p-4 border-t">
                <input id="chatbot-input" type="text" class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Ask your question..." data-translate="chat-placeholder">
            </div>
        </div>
    </div>

    <div id="newsletter-banner" class="newsletter-banner hidden">
        <p class="mb-2 text-gray-600" data-translate="newsletter-text">Subscribe to our newsletter for exclusive offers!</p>
        <div class="flex justify-center space-x-2">
            <input type="email" id="newsletter-email" class="px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800" placeholder="Your email" data-translate="newsletter-email-placeholder">
            <button id="newsletter-submit" class="px-4 py-1.5 bg-red-800 hover:bg-red-900 text-white rounded transition" data-translate="newsletter-button">Subscribe</button>
        </div>
    </div>

    <footer class="bg-red-800 text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-red-100" data-translate="footer-text">&copy; 2025 Guaraní Finest Brew. All rights reserved.</p>
        </div>
    </footer>

    <script>
    // Define dynamic discount percentages (adjustable according to your preferences)
    let discounts = {
        'illy': 15,    // Percentage for Illy Cafe Classic
        'guarana': 10, // Percentage for Guarana
        'cynara': 8    // Percentage for Cynara Oil
    };

    // Function to dynamically update promotions
    function updatePromotions() {
        const illyOriginalPrice = 354.25;
        const guaranaOriginalPrice = 13.50;
        const cynaraOriginalPrice = 11.95;

        const illyDiscount = illyOriginalPrice * (discounts['illy'] / 100);
        const illyDiscountedPrice = illyOriginalPrice - illyDiscount;
        document.getElementById('discount-illy').textContent = `${discounts['illy']}% off`;
        document.getElementById('price-illy').innerHTML = `${illyDiscountedPrice.toFixed(2)}€ <del>${illyOriginalPrice.toFixed(2)}€</del>`;

        const guaranaDiscount = guaranaOriginalPrice * (discounts['guarana'] / 100);
        const guaranaDiscountedPrice = guaranaOriginalPrice - guaranaDiscount;
        document.getElementById('discount-guarana').textContent = `${discounts['guarana']}% off`;
        document.getElementById('price-guarana').innerHTML = `${guaranaDiscountedPrice.toFixed(2)}€ <del>${guaranaOriginalPrice.toFixed(2)}€</del>`;

        const cynaraDiscount = cynaraOriginalPrice * (discounts['cynara'] / 100);
        const cynaraDiscountedPrice = cynaraOriginalPrice - cynaraDiscount;
        document.getElementById('discount-cynara').textContent = `${discounts['cynara']}% off`;
        document.getElementById('price-cynara').innerHTML = `${cynaraDiscountedPrice.toFixed(2)}€ <del>${cynaraOriginalPrice.toFixed(2)}€</del>`;
    }

    // Update promotions on page load
    updatePromotions();

        const translations = {
    en: {
        "title": "Guaraní Finest Brew",
        "nav-products": "Products",
        "nav-about": "About",
        "nav-contact": "Contact",
        "nav-promotions": "Promotions",
        "products-title": "Our Products",
        "veracruzano-name": "Veracruzano Premium Export",
        "veracruzano-desc": "Floral and citrus notes.",
        "capacity-label": "Quantity",
        "grind-label": "Bean Type",
        "classic-label": "Classic",
        "decaf-label": "Decaf",
        "details-link": "Details",
        "add-to-cart": "Add",
        "promotions-title": "Promotions",
        "illy-name": "Illy Cafe Classic",
        "illy-desc": "100% Arabica Brazil",
        "discount-label": "off",
        "guarana-name": "Guarana",
        "guarana-desc": "Energy support, cognitive performance",
        "cynara-name": "Cynara Oil",
        "cynara-desc": "Antioxidant and detoxifying.",
        "about-title": "About",
        "about-text": "Guaraní Finest Brew celebrates authentic flavors from around the world. Since 2025, we carefully select coffees, teas, and essential oils to offer you a unique experience in Paraguay. <a href='about.html' class='text-red-800 underline'>Discover our story</a>.",
        "discover-link": "Discover our story",
        "contact-title": "Contact",
        "contact-text": "123 Flavor Street, Asunción, Paraguay | Email: contact@guaranifinestbrew.com",
        "name-placeholder": "Your name",
        "email-placeholder": "Your email",
        "message-placeholder": "Your message",
        "send-button": "Send",
        "cart-title": "Cart & Order",
        "cart-empty": "Your cart is empty",
        "total-label": "Total",
        "first-name-label": "First Name",
        "first-name-placeholder": "John",
        "last-name-label": "Last Name",
        "last-name-placeholder": "Doe",
        "email-label": "Email",
        "address-label": "Address",
        "address-placeholder": "123 Example Street",
        "city-label": "City",
        "city-placeholder": "Asunción",
        "postal-code-label": "Postal Code",
        "postal-code-placeholder": "1234",
        "country-label": "Country",
        "country-placeholder": "Select a country",
        "carrier-label": "Carrier",
        "carrier-placeholder": "Select a carrier",
        "method-label": "Shipping Method",
        "method-placeholder": "Select a method",
        "shipping-details": "Price: -€ | Delivery: - days",
        "payment-label": "Payment",
        "bank-transfer": "Bank Transfer",
        "confirm-button": "Confirm Order",
        "chat-placeholder": "Ask your question...",
        "newsletter-text": "Subscribe to our newsletter for exclusive offers!",
        "newsletter-email-placeholder": "Your email",
        "newsletter-button": "Subscribe",
        "footer-text": "© 2025 Guaraní Finest Brew. All rights reserved.",
        "order-confirmed": "Order placed!",
        "client-label": "Client: ",
        "payment-method-label": "Method: ",
        "shipping-label": "Shipping: ",
        "thank-you": "Thank you for your purchase!",
        "login-button": "Log In",
        "hero-title": "Exceptional Flavors",
        "view-products": "View Products",
        "filter-all": "All",
        "filter-coffee": "Coffee",
        "filter-tea": "Tea",
        "filter-essential-oils": "Essential Oils",
        "grind-whole": "Whole",
        "grind-ground": "Ground",
        "grind-espresso": "Espresso",
        "tea1-name": "Green Maté",
        "tea1-desc": "Between green tea and coffee",
        "tea2-name": "Classic Maté",
        "tea2-desc": "A maté with vegetal and mineral notes, with smoky nuances",
        "tea3-name": "Guarana",
        "tea3-desc": "Energy support, cognitive performance",
        "oil1-name": "Palo Santo",
        "oil1-desc": "Anti-inflammatory",
        "oil2-name": "Pink Berries",
        "oil2-desc": "Energizing",
        "oil3-name": "Cynara Oil",
        "oil3-desc": "Antioxidant and detoxifying",
        "oil4-name": "Melissa Oil",
        "oil4-desc": "Sedative and soothes nervous tension",
        "oil5-name": "Lime Oil",
        "oil5-desc": "Anti-inflammatory, antispasmodic",
        "type-label": "Type",
        "green-label": "Green",
        "black-label": "Black",
        "white-label": "White",
        "usage-label": "Usage",
        "coffee2-name": "Colombian Supremo Coffee",
        "coffee2-desc": "Chocolate and hazelnut aromas.",
        "coffee3-name": "Illy Cafe Classic",
        "coffee3-desc": "100% Arabica Brazil",
        "coffee4-name": "Época Coffee",
        "coffee4-desc": "Notes of tropical fruit, chocolate, and nuts."
    },
    fr: {
        "title": "Guaraní Finest Brew",
        "nav-products": "Produits",
        "nav-about": "À propos",
        "nav-contact": "Contact",
        "nav-promotions": "Promotions",
        "products-title": "Nos Produits",
        "veracruzano-name": "Veracruzano Premium Export",
        "veracruzano-desc": "Notes florales et citronnées.",
        "capacity-label": "Contenance",
        "grind-label": "Type de grain",
        "classic-label": "Classique",
        "decaf-label": "Décaféiné",
        "details-link": "Détails",
        "add-to-cart": "Ajouter",
        "promotions-title": "Promotions",
        "illy-name": "Illy Cafe Classique",
        "illy-desc": "100% Arabica Brasil",
        "discount-label": "de réduction",
        "guarana-name": "Guarana",
        "guarana-desc": "soutien énergétique, performances cognitives",
        "cynara-name": "Huile de Cynara",
        "cynara-desc": "Anti-oxydantes et détoxifiantes.",
        "about-title": "À propos",
        "about-text": "Guaraní Finest Brew célèbre les saveurs authentiques du monde entier. Depuis 2025, nous sélectionnons avec soin des cafés, thés et huiles essentielles pour vous offrir une expérience unique au Paraguay. <a href='about.html' class='text-red-800 underline'>Découvrez notre histoire</a>.",
        "discover-link": "Découvrez notre histoire",
        "contact-title": "Contact",
        "contact-text": "123 Rue des Saveurs, Asunción, Paraguay | Email : contact@guaranifinestbrew.com",
        "name-placeholder": "Votre nom",
        "email-placeholder": "Votre email",
        "message-placeholder": "Votre message",
        "send-button": "Envoyer",
        "cart-title": "Panier & Commande",
        "cart-empty": "Votre panier est vide",
        "total-label": "Total",
        "first-name-label": "Prénom",
        "first-name-placeholder": "Jean",
        "last-name-label": "Nom",
        "last-name-placeholder": "Dupont",
        "email-label": "Email",
        "address-label": "Adresse",
        "address-placeholder": "123 Rue Exemple",
        "city-label": "Ville",
        "city-placeholder": "Asunción",
        "postal-code-label": "Code postal",
        "postal-code-placeholder": "1234",
        "country-label": "Pays",
        "country-placeholder": "Sélectionner un pays",
        "carrier-label": "Transporteur",
        "carrier-placeholder": "Sélectionner un transporteur",
        "method-label": "Mode de livraison",
        "method-placeholder": "Sélectionner un mode",
        "shipping-details": "Prix : -€ | Délai : - jours",
        "payment-label": "Paiement",
        "bank-transfer": "Virement bancaire",
        "confirm-button": "Confirmer la commande",
        "chat-placeholder": "Posez votre question...",
        "newsletter-text": "Inscrivez-vous à notre newsletter pour des offres exclusives !",
        "newsletter-email-placeholder": "Votre email",
        "newsletter-button": "S’inscrire",
        "footer-text": "© 2025 Guaraní Finest Brew. Tous droits réservés.",
        "order-confirmed": "Commande passée !",
        "client-label": "Client: ",
        "payment-method-label": "Méthode: ",
        "shipping-label": "Livraison: ",
        "thank-you": "Merci pour votre achat !",
        "login-button": "Se connecter",
        "hero-title": "Saveurs Exceptionnelles",
        "view-products": "Voir les produits",
        "filter-all": "Tous",
        "filter-coffee": "Café",
        "filter-tea": "Thé",
        "filter-essential-oils": "Huiles essentielles",
        "grind-whole": "Entier",
        "grind-ground": "Moulu",
        "grind-espresso": "Espresso",
        "tea1-name": "Maté Vert",
        "tea1-desc": "Entre thé vert et café",
        "tea2-name": "Maté Classique",
        "tea2-desc": "Un maté aux notes végétales et minérales, avec des nuances fumées",
        "tea3-name": "Guarana",
        "tea3-desc": "Soutien énergétique, performances cognitives",
        "oil1-name": "Palo Santo",
        "oil1-desc": "Anti-inflammatoire",
        "oil2-name": "Baies Roses",
        "oil2-desc": "Énergisant",
        "oil3-name": "Huile de Cynara",
        "oil3-desc": "Antioxydante et détoxifiante",
        "oil4-name": "Huile de Mélisse",
        "oil4-desc": "Sédatif et apaise les tensions nerveuses",
        "oil5-name": "Huile de Citron Vert",
        "oil5-desc": "Anti-inflammatoire, antispasmodique",
        "type-label": "Type",
        "green-label": "Vert",
        "black-label": "Noir",
        "white-label": "Blanc",
        "usage-label": "Utilisation",
        "coffee2-name": "Café Supremo Colombien",
        "coffee2-desc": "Arômes de chocolat et de noisette.",
        "coffee3-name": "Illy Cafe Classique",
        "coffee3-desc": "100% Arabica Brasil",
        "coffee4-name": "Café Época",
        "coffee4-desc": "Notes de fruits tropicaux, chocolat et noix.",
        "veracruzano-name": "Veracruzano Premium Export",
        "veracruzano-desc": "Notes florales et citronnées."
    },
    es: {
        "title": "Guaraní Finest Brew",
        "nav-products": "Productos",
        "nav-about": "Acerca de",
        "nav-contact": "Contacto",
        "nav-promotions": "Promociones",
        "products-title": "Nuestros Productos",
        "veracruzano-name": "Veracruzano Premium Export",
        "veracruzano-desc": "Notas florales y cítricas.",
        "capacity-label": "Cantidad",
        "grind-label": "Tipo de grano",
        "classic-label": "Clásico",
        "decaf-label": "Descafeinado",
        "details-link": "Detalles",
        "add-to-cart": "Añadir",
        "promotions-title": "Promociones",
        "illy-name": "Illy Cafe Clásico",
        "illy-desc": "100% Arabica Brasil",
        "discount-label": "de descuento",
        "guarana-name": "Guaraná",
        "guarana-desc": "Soporte energético, rendimiento cognitivo",
        "cynara-name": "Aceite de Cynara",
        "cynara-desc": "Antioxidante y desintoxicante.",
        "about-title": "Acerca de",
        "about-text": "Guaraní Finest Brew celebra los sabores auténticos de todo el mundo. Desde 2025, seleccionamos cuidadosamente cafés, tés y aceites esenciales para ofrecerte una experiencia única en Paraguay. <a href='about.html' class='text-red-800 underline'>Descubre nuestra historia</a>.",
        "discover-link": "Descubre nuestra historia",
        "contact-title": "Contacto",
        "contact-text": "123 Calle de los Sabores, Asunción, Paraguay | Email: contact@guaranifinestbrew.com",
        "name-placeholder": "Tu nombre",
        "email-placeholder": "Tu email",
        "message-placeholder": "Tu mensaje",
        "send-button": "Enviar",
        "cart-title": "Carrito & Pedido",
        "cart-empty": "Tu carrito está vacío",
        "total-label": "Total",
        "first-name-label": "Nombre",
        "first-name-placeholder": "Juan",
        "last-name-label": "Apellido",
        "last-name-placeholder": "Pérez",
        "email-label": "Email",
        "address-label": "Dirección",
        "address-placeholder": "123 Calle Ejemplo",
        "city-label": "Ciudad",
        "city-placeholder": "Asunción",
        "postal-code-label": "Código postal",
        "postal-code-placeholder": "1234",
        "country-label": "País",
        "country-placeholder": "Seleccionar un país",
        "carrier-label": "Transportista",
        "carrier-placeholder": "Seleccionar transportista",
        "method-label": "Método de envío",
        "method-placeholder": "Seleccionar método",
        "shipping-details": "Precio: -€ | Entrega: - días",
        "payment-label": "Pago",
        "bank-transfer": "Transferencia bancaria",
        "confirm-button": "Confirmar pedido",
        "chat-placeholder": "Haz tu pregunta...",
        "newsletter-text": "¡Suscríbete a nuestro boletín para ofertas exclusives!",
        "newsletter-email-placeholder": "Tu email",
        "newsletter-button": "Suscribirse",
        "footer-text": "© 2025 Guaraní Finest Brew. Todos los derechos reservados.",
        "order-confirmed": "¡Pedido realizado!",
        "client-label": "Cliente: ",
        "payment-method-label": "Método: ",
        "shipping-label": "Envío: ",
        "thank-you": "¡Gracias por tu compra!",
        "login-button": "Iniciar sesión",
        "hero-title": "Sabores Excepcionales",
        "view-products": "Ver productos",
        "filter-all": "Todo",
        "filter-coffee": "Café",
        "filter-tea": "Té",
        "filter-essential-oils": "Aceites esenciales",
        "grind-whole": "Entero",
        "grind-ground": "Molienda",
        "grind-espresso": "Expreso",
        "tea1-name": "Maté Verde",
        "tea1-desc": "Entre té verde y café",
        "tea2-name": "Maté Clásico",
        "tea2-desc": "Un maté con notas vegetales y minerales, con matices ahumados",
        "tea3-name": "Guaraná",
        "tea3-desc": "Soporte energético, rendimiento cognitivo",
        "oil1-name": "Palo Santo",
        "oil1-desc": "Antiinflamatorio",
        "oil2-name": "Bayas Rosadas",
        "oil2-desc": "Energizante",
        "oil3-name": "Aceite de Cynara",
        "oil3-desc": "Antioxidante y desintoxicante",
        "oil4-name": "Aceite de Melisa",
        "oil4-desc": "Sedante y alivia la tensión nerviosa",
        "oil5-name": "Aceite de Lima",
        "oil5-desc": "Antiinflamatorio, antiespasmódico",
        "type-label": "Tipo",
        "green-label": "Verde",
        "black-label": "Negro",
        "white-label": "Blanco",
        "usage-label": "Uso",
        "coffee2-name": "Café Supremo Colombiano",
        "coffee2-desc": "Arômes de chocolate y avellana.",
        "coffee3-name": "Illy Cafe Clásico",
        "coffee3-desc": "100% Arabica Brasil",
        "coffee4-name": "Café Época",
        "coffee4-desc": "Notas de frutas tropicales, chocolate y nueces.",
        "veracruzano-name": "Veracruzano Premium Export",
        "veracruzano-desc": "Notas florales y cítricas."
    }
};

        const currencyRates = {
        EUR: 1,
        USD: 1.1,
        CHF: 0.95
    };

    let currentLanguage = 'en'; // Default language set to English based on your input
    let currentCurrency = 'EUR';
    // let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    function translatePage(lang) {
        currentLanguage = lang;
        document.querySelector('html').setAttribute('lang', lang);
        document.title = translations[lang]["title"];
        document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            if (translations[lang][key]) {
                console.log(`Translating key: ${key}, value: ${translations[lang][key]}, element:`, element);
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translations[lang][key];
                } else if (element.tagName === 'SELECT' && element.options) {
                    Array.from(element.options).forEach((option, index) => {
                        const optionKey = option.getAttribute('data-translate');
                        if (optionKey) {
                            option.text = translations[lang][optionKey] || option.text;
                        }
                    });
                } else if (element.tagName === 'A') {
                    element.textContent = translations[lang][key]; // Update link text
                } else {
                    element.textContent = translations[lang][key]; // Use textContent instead of innerHTML
                }
            } else {
                console.log(`Translation not found for key: ${key} in lang: ${lang}`);
            }
        });
    }

    // Appeler la fonction au chargement avec la langue par défaut (ex. "en")
    document.addEventListener('DOMContentLoaded', () => {
        translatePage(currentLanguage || 'en'); // Remplace 'en' par ta langue par défaut si différente
    });

    function updatePrices() {
        const rate = currencyRates[currentCurrency];
        document.querySelectorAll('[id^="price-"]').forEach(priceElement => {
            let originalPrice = parseFloat(priceElement.textContent.replace('€', '').replace('$', '').replace('CHF', '').replace(',', '.'));
            let newPrice = (originalPrice * rate).toFixed(2);
            priceElement.textContent = `${newPrice}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}`;
        });
        const shippingDetails = document.getElementById('shipping-details');
        if (shippingDetails.dataset.price) {
            let shippingPrice = parseFloat(shippingDetails.dataset.price) * rate;
            shippingDetails.textContent = `Price: ${shippingPrice.toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'} | Delivery: - days`;
        }
    }

    document.getElementById('language-select').addEventListener('change', (e) => {
        translatePage(e.target.value);
    });

    document.getElementById('currency-select').addEventListener('change', (e) => {
        currentCurrency = e.target.value;
        updatePrices();
        updateCart();
        updatePromotions(); // Update promotions with the new currency
    });

    const products = [
        {id:'coffee1',name:'Veracruzano Premium Export',price:{'250g':88.24,'500g':177.12,'1kg':356.00},category:'coffee',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753896069/caf%C3%A9%20de%20Veracruz.jpg',description:'Floral and citrus notes.'},
        {id:'coffee2',name:'Colombian Supremo Coffee',price:{'250g':188.50,'500g':354.00,'1kg':690.00},category:'coffee',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753886877/coffee-colombian_up6quo.jpg',description:'Chocolate and hazelnut aromas.'},
        {id:'coffee3',name:'Illy Cafe Classic',price:{'250g':301.11,'500g':602.23,'1kg':1186.00},category:'coffee',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753896691/Illy%20Cafe%20Classic.jpg',description:'100% Arabica Brazil'},
        {id:'coffee4',name:'Época Coffee',price:{'250g':149.71,'500g':299.42,'1kg':598.84},category:'coffee',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753896079/coffee-epoca.jpg',description:'Notes of tropical fruit, chocolate, and nuts.'},
        {id:'tea1',name:'Green Maté',price:{'100g':11.60,'200g':22.40,'500g':52.70},category:'tea',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753962586/mat%C3%A9_vert_ccnjeu.jpg',description:'Between green tea and coffee'},
        {id:'tea2',name:'Classic Maté',price:{'100g':11.30,'200g':22.15,'500g':52.00},category:'tea',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753962575/mat%C3%A9_clsssico_lgyzud.jpg',description:'A maté with vegetal and mineral notes, with smoky nuances'},
        {id:'tea3',name:'Guarana',price:{'100g':12.15,'200g':23.40,'500g':54.00},category:'tea',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1753961202/guarana-bio.webp',description:'Energy support, cognitive performance'},
        {id:'oil1',name:'Palo Santo',price:{'10ml':42.90,'30ml':71.80,'50ml':128.30},category:'oil',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1754046769/palo-santo_juw6dl.webp',description:'Anti-inflammatory.'},
        {id:'oil2',name:'Pink Berries',price:{'10ml':9.90,'30ml':26.60,'50ml':39.60},category:'oil',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1754048586/huile-essentielle-de-baies-roses_duj4a0.png',description:'Energizing.'},
        {id:'oil3',name:'Cynara Oil',price:{'10ml':10.99,'30ml':22.73,'50ml':34.22},category:'oil',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1754049551/Huile_cynara_ykxtvq.png',description:'Antioxidant and detoxifying.'},
        {id:'oil4',name:'Melissa Oil',price:{'10ml':33.71,'30ml':65.40,'50ml':96.90},category:'oil',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1754050805/huile-essentielle-de-melisse_yfgwna.png',description:'Sedative and soothes nervous tension.'},
        {id:'oil5',name:'Lime Oil',price:{'10ml':3.45,'30ml':8.95,'50ml':14.90},category:'oil',image:'https://res.cloudinary.com/dweom4cyp/image/upload/v1754051938/huile_limette_vvgech.webp',description:'Anti-inflammatory, antispasmodic.'}
    ];

    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    const cartBtn = document.getElementById('cart-btn'), closeCartBtn = document.getElementById('close-cart'), cartModal = document.getElementById('cart-modal'), cartItems = document.getElementById('cart-items'), cartTotal = document.getElementById('cart-total'), cartCount = document.getElementById('cart-count'), confirmBtn = document.getElementById('confirm-btn'), firstNameInput = document.getElementById('first-name'), lastNameInput = document.getElementById('last-name'), emailInput = document.getElementById('email'), addressInput = document.getElementById('address'), cityInput = document.getElementById('city'), postalCodeInput = document.getElementById('postal-code'), countrySelect = document.getElementById('country'), paymentSelect = document.getElementById('payment'), productGrid = document.getElementById('product-grid'), chatbotToggle = document.getElementById('chatbot-toggle'), chatbotContainer = document.getElementById('chatbot-container'), chatbotMessages = document.getElementById('chatbot-messages'), chatbotInput = document.getElementById('chatbot-input'), contactForm = document.getElementById('contact-form'), newsletterBanner = document.getElementById('newsletter-banner'), newsletterEmail = document.getElementById('newsletter-email'), newsletterSubmit = document.getElementById('newsletter-submit'), shippingCarrierSelect = document.getElementById('shipping-carrier'), shippingMethodSelect = document.getElementById('shipping-method'), shippingDetails = document.getElementById('shipping-details');

    const shippingRates = {
        ups: {standard: {price: 5.99, days: '10-15'}, express: {price: 15.99, days: '2-4'}, relay: {price: 3.99, days: '7-12'}},
        dhl: {standard: {price: 6.49, days: '10-15'}, express: {price: 16.49, days: '1-3'}, relay: {price: 4.49, days: '7-12'}},
        chronopost: {standard: {price: 5.49, days: '10-15'}, express: {price: 14.99, days: '2-5'}, relay: {price: 3.49, days: '7-12'}},
        mondialrelay: {standard: {price: 4.99, days: '10-15'}, express: {price: 13.99, days: '2-5'}, relay: {price: 2.99, days: '7-12'}}
    };

    function toggleModal() {
        cartModal.classList.toggle('open');
        document.body.classList.toggle('overflow-hidden');
        if (cart.length > 0) updateShippingOptions();
    }

    cartBtn.addEventListener('click', toggleModal);
    closeCartBtn.addEventListener('click', toggleModal);

    function updateCart() {
        const rate = currencyRates[currentCurrency];
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        let totalPrice = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
        const shippingCost = parseFloat(shippingDetails.dataset.price) || 0;
        totalPrice += shippingCost;
        cartCount.textContent = totalItems;
        cartTotal.textContent = `${(totalPrice * rate).toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}`;
        if (cart.length === 0) {
            cartItems.innerHTML = '<p class="text-gray-500 text-center py-4" data-translate="cart-empty">Your cart is empty</p>';
            confirmBtn.disabled = true;
            shippingCarrierSelect.disabled = true;
            shippingMethodSelect.disabled = true;
            shippingDetails.textContent = `Price: -${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'} | Delivery: - days`;
            shippingDetails.dataset.price = 0;
        } else {
            cartItems.innerHTML = cart.map(item => `<div class="flex items-center py-2 border-b"><img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded"><div class="ml-3 flex-1"><h4 class="font-medium text-sm">${item.name} (${item.capacity}${item.caffeine ? ',' + item.caffeine : ''}${item.grind ? ',' + item.grind : ''}${item.type ? ',' + item.type : ''}${item.usage ? ',' + item.usage : ''})</h4><p class="text-gray-600 text-xs">${(item.price * rate).toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}</p></div><div class="flex items-center"><button onclick="changeQuantity('${item.compositeId}',-1)" class="text-gray-500 hover:text-red-800 px-1"><i class="fas fa-minus text-xs"></i></button><span class="quantity mx-1 text-sm">${item.quantity}</span><button onclick="changeQuantity('${item.compositeId}',1)" class="text-gray-500 hover:text-red-900 px-1"><i class="fas fa-plus text-xs"></i></button></div></div>`).join('');
            confirmBtn.disabled = false;
            shippingCarrierSelect.disabled = false;
        }
        saveCart(); // Sauvegarde le panier après chaque mise à jour
    }

    function changeQuantity(id, delta) {
        const item = cart.find(i => i.compositeId === id);
        if (item) {
            item.quantity += delta;
            if (item.quantity <= 0) cart = cart.filter(i => i.compositeId !== id);
            updateCart();
        }
    }

    function renderProducts(category = 'all') {
        const filteredProducts = category === 'all' ? products : products.filter(p => p.category === category);
        productGrid.innerHTML = filteredProducts.map(product => `<div class="product-card bg-white rounded-lg shadow-md transition"><img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover rounded-t-lg"><div class="p-4"><h3 class="text-lg font-semibold" data-translate="${product.id === 'coffee1' ? 'veracruzano-name' : product.id + '-name'}">${product.name}</h3><p class="text-gray-600 text-sm mb-2" data-translate="${product.id === 'coffee1' ? 'veracruzano-desc' : product.id + '-desc'}">${product.description}</p><div class="mb-2"><label for="capacity-${product.id}" class="block text-gray-700 text-sm font-medium mb-1" data-translate="capacity-label">Quantity</label><select id="capacity-${product.id}" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800">${Object.keys(product.price).map(cap => `<option value="${cap}">${cap}</option>`).join('')}</select></div>${product.category === 'coffee' ? `<div class="mb-2"><label for="grind-${product.id}" class="block text-gray-700 text-sm font-medium mb-1" data-translate="grind-label">Bean Type</label><select id="grind-${product.id}" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800"><option value="whole" data-translate="grind-whole">Whole</option><option value="ground" data-translate="grind-ground">Ground</option><option value="espresso" data-translate="grind-espresso">Espresso</option></select></div><div class="mb-2 caffeine-options"><div class="caffeine-option"><input type="radio" id="classic-${product.id}" name="caffeine-${product.id}" value="classic" checked><label for="classic-${product.id}" data-translate="classic-label">Classic</label></div><div class="caffeine-option"><input type="radio" id="decaf-${product.id}" name="caffeine-${product.id}" value="decaf"><label for="decaf-${product.id}" data-translate="decaf-label">Decaf</label></div></div>` : product.category === 'tea' ? `<div class="mb-2"><label for="type-${product.id}" class="block text-gray-700 text-sm font-medium mb-1" data-translate="type-label">Type</label><select id="type-${product.id}" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800"><option value="${product.name.includes('Green')?'green':product.name.includes('Classic')?'black':'white'}" data-translate="${product.name.includes('Green')?'green-label':product.name.includes('Classic')?'black-label':'white-label'}">${product.name.includes('Green')?'Green':product.name.includes('Classic')?'Black':'White'}</option></select></div>` : `<div class="mb-2"><label for="usage-${product.id}" class="block text-gray-700 text-sm font-medium mb-1" data-translate="usage-label">Usage</label><select id="usage-${product.id}" class="w-full px-3 py-1.5 border rounded focus:outline-none focus:ring-2 focus:ring-red-800"><option value="${product.name.includes('Palo Santo')?'anti-inflammatory':product.name.includes('Pink Berries')?'energizing':product.name.includes('Cynara Oil')?'antioxidant-and-detoxifying':product.name.includes('Melissa Oil')?'sedative-and-soothes-nervous-tension':product.name.includes('Lime Oil')?'anti-inflammatory-antispasmodic':'purifying'}" data-translate="${product.name.includes('Palo Santo')?'oil1-desc':product.name.includes('Pink Berries')?'oil2-desc':product.name.includes('Cynara Oil')?'oil3-desc':product.name.includes('Melissa Oil')?'oil4-desc':product.name.includes('Lime Oil')?'oil5-desc':'oilX-desc'}">${product.name.includes('Palo Santo')?'Anti-inflammatory':product.name.includes('Pink Berries')?'Energizing':product.name.includes('Cynara Oil')?'Antioxidant and detoxifying':product.name.includes('Melissa Oil')?'Sedative and soothes nervous tension':product.name.includes('Lime Oil')?'Anti-inflammatory, antispasmodic':'Purifying'}</option></select></div>`}<div class="flex justify-between items-center"><span id="price-${product.id}" class="text-red-800 font-bold">${(Object.values(product.price)[0] * currencyRates[currentCurrency]).toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}</span><a href="${product.id}.html" class="text-blue-600 hover:underline" data-translate="details-link">Details</a><button class="add-to-cart bg-red-800 text-white px-4 py-2 rounded hover:bg-red-900" data-id="${product.id}" data-translate="add-to-cart">Add</button></div></div></div>`).join('');
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.addEventListener('click', e => {
                const productId = e.target.dataset.id;
                const product = products.find(p => p.id === productId);
                if (!product) return; // Safety if product not found
                const capacity = document.getElementById(`capacity-${productId}`).value;
                if (product.category === 'coffee') {
                    const caffeine = document.querySelector(`input[name="caffeine-${productId}"]:checked`)?.value || 'classic';
                    const grind = document.getElementById(`grind-${product.id}`).value || 'whole';
                    const compositeId = `${productId}-${capacity}-${caffeine}-${grind}`;
                    const price = product.price[capacity] || Object.values(product.price)[0];
                    let existingItem = cart.find(item => item.compositeId === compositeId);
                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ ...product, compositeId, capacity, caffeine, grind, quantity: 1, price: price });
                    }
                } else {
                    let caffeine = '', grind = '', type = '', usage = '';
                    if (product.category === 'tea') type = document.getElementById(`type-${productId}`).value || '';
                    else usage = document.getElementById(`usage-${productId}`).value || '';
                    const compositeId = `${productId}-${capacity}-${caffeine || ''}-${grind || ''}-${type || ''}-${usage || ''}`;
                    const price = product.price[capacity] || Object.values(product.price)[0];
                    let existingItem = cart.find(item => item.compositeId === compositeId);
                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ ...product, compositeId, capacity, caffeine, grind, type, usage, quantity: 1, price: price });
                    }
                }
                updateCart();
                toggleModal();
                const priceElement = document.getElementById(`price-${productId}`);
                if (priceElement) {
                    priceElement.textContent = `${(product.price[capacity] * currencyRates[currentCurrency]).toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}`;
                }
            });
        });
        document.querySelectorAll('[id^="capacity-"]').forEach(select => {
            const productId = select.id.replace('capacity-', '');
            const product = products.find(p => p.id === productId);
            select.addEventListener('change', () => {
                const capacity = select.value;
                const price = product.price[capacity] * currencyRates[currentCurrency];
                document.getElementById(`price-${productId}`).textContent = `${price.toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}`;
            });
        });
    }

    document.querySelectorAll('.category-filter').forEach(btn => {
        btn.addEventListener('click', e => {
            renderProducts(e.target.dataset.category);
        });
    });

    function showConfirmationMessage(firstName, lastName, email, address, city, postalCode, country, paymentMethod, total, shippingDetails) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'confirmation-message';
        messageDiv.innerHTML = `<p class="font-bold" data-translate="order-confirmed">Order placed!</p><p data-translate="client-label">Client: ${firstName} ${lastName}</p><p data-translate="email-label">Email: ${email}</p><p data-translate="address-label">Address: ${address}, ${city}, ${postalCode}, ${country}</p><p data-translate="payment-method-label">Method: ${paymentMethod === 'visa' ? 'Visa' : paymentMethod === 'mastercard' ? 'Mastercard' : paymentMethod === 'paypal' ? 'PayPal' : 'Bank Transfer'}</p><p data-translate="shipping-label">Shipping: ${shippingDetails.carrier} - ${shippingDetails.method} (${shippingDetails.price}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}, ${shippingDetails.days} days)</p><p data-translate="total-label">Total amount: ${total.toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'}</p><p class="font-bold mt-2" data-translate="thank-you">Thank you for your purchase!</p>`;
        document.body.appendChild(messageDiv);
        setTimeout(() => { messageDiv.remove(); }, 5000);
    }

    confirmBtn.addEventListener('click', () => {
        if (cart.length === 0) {
            alert(translations[currentLanguage]["cart-empty"]);
            return;
        }
        const firstName = firstNameInput.value.trim(), lastName = lastNameInput.value.trim(), email = emailInput.value.trim(), address = addressInput.value.trim(), city = cityInput.value.trim(), postalCode = postalCodeInput.value.trim(), country = countrySelect.value.trim(), paymentMethod = paymentSelect.value, carrier = shippingCarrierSelect.value, method = shippingMethodSelect.value, shippingCost = parseFloat(shippingDetails.dataset.price) || 0, total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0) + shippingCost;
        if (!firstName || !lastName || !email || !email.includes('@') || !address || !city || !postalCode || !country || !carrier || !method) {
            alert(translations[currentLanguage]["cart-empty"]);
            return;
        }
        showConfirmationMessage(firstName, lastName, email, address, city, postalCode, country, paymentMethod, total * currencyRates[currentCurrency], {carrier: carrier.charAt(0).toUpperCase() + carrier.slice(1), method: method.charAt(0).toUpperCase() + method.slice(1), price: (shippingCost * currencyRates[currentCurrency]).toFixed(2), days: shippingRates[carrier][method].days});
        cart = [];
        firstNameInput.value = ''; lastNameInput.value = ''; emailInput.value = ''; addressInput.value = ''; cityInput.value = ''; postalCodeInput.value = ''; countrySelect.value = '';
        shippingCarrierSelect.value = ''; shippingMethodSelect.innerHTML = '<option value="" data-translate="method-placeholder">Select a method</option>'; shippingMethodSelect.disabled = true;
        updateCart();
        toggleModal();
    });

    contactForm.addEventListener('submit', e => {
        e.preventDefault();
        const name = document.getElementById('contact-name').value.trim(), email = document.getElementById('contact-email').value.trim(), message = document.getElementById('contact-message').value.trim();
        if (name && email && email.includes('@') && message) {
            alert(translations[currentLanguage]["send-button"] + ' ' + translations[currentLanguage]["thank-you"]);
            contactForm.reset();
        } else {
            alert(translations[currentLanguage]["cart-empty"]);
        }
    });

    newsletterSubmit.addEventListener('click', () => {
        const email = newsletterEmail.value.trim();
        if (email && email.includes('@')) {
            alert(translations[currentLanguage]["newsletter-button"] + ' ' + translations[currentLanguage]["thank-you"]);
            newsletterEmail.value = '';
            newsletterBanner.classList.add('hidden');
        } else {
            alert(translations[currentLanguage]["cart-empty"]);
        }
    });

    setTimeout(() => { newsletterBanner.classList.remove('hidden'); }, 5000);

    function addChatMessage(message, isUser = false) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${isUser ? 'user-message' : 'bot-message'}`;
        messageDiv.textContent = message;
        chatbotMessages.appendChild(messageDiv);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }

        function getBotResponse(userInput) {
        userInput = userInput.toLowerCase().trim();
        if (userInput.includes('coffee') || userInput.includes('café')) return translations[currentLanguage]["veracruzano-name"] + ', ' + translations[currentLanguage]["illy-name"] + '. ' + translations[currentLanguage]["capacity-label"] + ': 250g/500g/1kg, ' + translations[currentLanguage]["grind-label"] + ': whole/ground/espresso, ' + translations[currentLanguage]["classic-label"] + '/' + translations[currentLanguage]["decaf-label"] + '.';
        else if (userInput.includes('quantity coffee') || userInput.includes('weight coffee')) return translations[currentLanguage]["capacity-label"] + ': 250g, 500g, or 1kg with adjusted prices.';
        else if (userInput.includes('caffeine') || userInput.includes('decaf')) return translations[currentLanguage]["classic-label"] + ' (with caffeine) or ' + translations[currentLanguage]["decaf-label"] + ' for each coffee.';
        else if (userInput.includes('ground') || userInput.includes('bean') || userInput.includes('espresso')) return translations[currentLanguage]["grind-label"] + ': whole beans, ground, or espresso.';
        else if (userInput.includes('tea') || userInput.includes('thé') || userInput.includes('maté')) return translations[currentLanguage]["guarana-name"] + ', ' + translations[currentLanguage]["cynara-name"] + '. ' + translations[currentLanguage]["capacity-label"] + ': 100g/200g/500g.';
        else if (userInput.includes('quantity tea') || userInput.includes('weight tea')) return translations[currentLanguage]["capacity-label"] + ': 100g, 200g, or 500g with adjusted prices.';
        else if (userInput.includes('oil') || userInput.includes('huile')) return translations[currentLanguage]["cynara-name"] + ' (antioxidant), ' + translations[currentLanguage]["guarana-name"] + ' (energizing). ' + translations[currentLanguage]["capacity-label"] + ': 10ml/30ml/50ml.';
        else if (userInput.includes('quantity oil') || userInput.includes('weight oil')) return translations[currentLanguage]["capacity-label"] + ': 10ml, 30ml, or 50ml with adjusted prices.';
        else if (userInput.includes('price') || userInput.includes('cost')) return translations[currentLanguage]["total-label"] + ' varies by ' + translations[currentLanguage]["capacity-label"] + ' and ' + translations[currentLanguage]["currency-select"] + '.';
        else if (userInput.includes('shipping') || userInput.includes('delivery')) return translations[currentLanguage]["shipping-details"] + ' depends on carrier and method.';
        else if (userInput.includes('help') || userInput.includes('support')) return translations[currentLanguage]["contact-text"];
        else return translations[currentLanguage]["chat-placeholder"];
    }

    chatbotToggle.addEventListener('click', () => {
        chatbotContainer.classList.toggle('hidden');
    });

    chatbotInput.addEventListener('keypress', e => {
        if (e.key === 'Enter' && chatbotInput.value.trim()) {
            addChatMessage(chatbotInput.value, true);
            const response = getBotResponse(chatbotInput.value);
            setTimeout(() => addChatMessage(response), 500);
            chatbotInput.value = '';
        }
    });

    shippingCarrierSelect.addEventListener('change', () => {
        const carrier = shippingCarrierSelect.value;
        shippingMethodSelect.innerHTML = Object.keys(shippingRates[carrier] || {}).map(method => `<option value="${method}" data-translate="${method}-label">${method.charAt(0).toUpperCase() + method.slice(1)}</option>`).join('');
        shippingMethodSelect.disabled = false;
        updateShippingOptions();
    });

    shippingMethodSelect.addEventListener('change', updateShippingOptions);

    function updateShippingOptions() {
        const carrier = shippingCarrierSelect.value;
        const method = shippingMethodSelect.value;
        if (carrier && method && shippingRates[carrier] && shippingRates[carrier][method]) {
            const { price, days } = shippingRates[carrier][method];
            shippingDetails.textContent = `Price: ${price.toFixed(2)}${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'} | Delivery: ${days} days`;
            shippingDetails.dataset.price = price;
        } else {
            shippingDetails.textContent = `Price: -${currentCurrency === 'EUR' ? '€' : currentCurrency === 'USD' ? '$' : 'CHF'} | Delivery: - days`;
            shippingDetails.dataset.price = 0;
        }
        updateCart();
    }

    // Initial rendering
    renderProducts();
    updateCart();
</script>
</body>
</html>
